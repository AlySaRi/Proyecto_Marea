

<body class="body-gallery">

  <div id="alert-success" style="display:none;">
  Se ha guardado correctamente 
  </div>



<h1 class="mis-recuerdos">Mis recuerdos</h1><hr>

<section class="menu-gallery">
<menu>
  <button id="exit">Salir del perfil</button>
</menu>
</section>



<script>
if (typeof document !== "undefined") {
  document.addEventListener("DOMContentLoaded", () => {
    const addNewCard = document.getElementById("addNewCard");
    const cancelButton = document.getElementById("cancel");
    const placeDialog = document.getElementById("placeDialog");
    const imageInput = document.getElementById("image");
    const preview = document.getElementById("preview");

    // Abrir el diálogo
    
    addNewCard.addEventListener("click", () => {
      placeDialog.showModal();
      // Limpiar preview cada vez que se abre
      preview.src = "";
      preview.style.display = "none";
      imageInput.value = "";
    });

    // Cerrar diálogo
    cancelButton.addEventListener("click", () => {
      placeDialog.close();
    });

    // Previsualización de la imagen
    imageInput.addEventListener("change", () => {
      const file = imageInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          preview.src = reader.result;
          preview.style.display = "block"; // Mostrar la imagen
        };
        reader.readAsDataURL(file);
      } else {
        preview.src = "";
        preview.style.display = "none";
      }
    });
  });
}
</script>
<script>   //Mensaje de éxito
  // Revisamos si en la URL existe [?success=true]
  const params = new URLSearchParams(window.location.search);
  if(params.get('success') === 'true'){
    const alert = document.getElementById('alert-success');
    alert.style.display = 'block';  // Mostrar el div
    // Desaparecer después de 3 segundos
    setTimeout(() => {
      alert.style.opacity = 0;  // Suave transición
      setTimeout(() => alert.style.display = 'none', 500); // ocultar del todo
    }, 3000);
  }
</script>


<section class="animales-guardados">

  <!-- Tarjeta para subir nueva foto -->
  <div class="add-new" id="addNewCard">
    <span class="plus-symbol">+</span>
    <p>Subir foto</p>
  </div>

  <!-- Tarjetas existentes -->
  {{#each projects}}
  <a href="/projects/{{this.id}}" class="card-link">
    <div class="card">
      <h3>{{this.title}}</h3>

      {{#if this.imageUrl}}
        <img src="{{this.imageUrl}}" alt="{{this.title}}" width="300">
      {{/if}}
    </div>
  </a>  
  
 {{/each}} 

</section>

<!-- Dialog para subir foto -->
<dialog id="placeDialog">
  <form action="/projects" method="POST" enctype="multipart/form-data">
    <p>Subir foto</p>
    <fieldset>

      <label for="name">Nombre:</label>
      <input type="text" id="name" name="title" required placeholder="Tortuga/Añadir con IA">

      <br><br>

      <label for="location">Lugar donde se encontró:</label>
      <input type="text" id="location" name="location" required placeholder="Ej: Cala del Portitxol">

      <br><br>

      <label for="description">Descripción:</label>
      <textarea id="description" name="description" placeholder="Escribe una descripción/O con la IA..." rows="3" style="width: 100%; resize: vertical;"></textarea>

      <br><br>

      <label for="image">Imagen:</label>
      <input type="file" id="image" name="image" accept="image/*" required>
      <small>Máximo 5MB</small>
      <img id="preview" src="" alt="Vista previa" style="display:none; width: 300px; margin-top: 10px;">
    </fieldset>

    <menu>
      <button type="submit" value="add">Guardar</button>
      <button id="cancel" value="cancel">Cancelar</button>
    </menu>
  </form>
</dialog>



</body>
<footer class="footer-gallery">© 2025 Mis recuerdos.</footer>
